- id: remote_kerstboom_pressed
  alias: Remote kerstboom pressed
  mode: restart
  trigger:
    platform: event
    event_type: hue_event
  condition:
    condition: template
    value_template: >
      {{
        trigger.event.data.id == "afstandsbediening_2"
        and (
          (trigger.event.data.event | string)[3:4] == "2"
          or (trigger.event.data.event | string)[3:4] == "3"
        )
      }}
  variables:
    light_entity: >
      {% if (trigger.event.data.event | string)[3:4] == "2" %}
        light.twinkly_strings
      {% else %}
        light.twinkly_icicle
      {% endif %}
  action:
    choose:
      - conditions:
          condition: template
          value_template: "{{ (trigger.event.data.event | string)[:1] == \"1\" }}"
        sequence:
          service: light.turn_on
          data_template:
            entity_id: "{{ light_entity }}"
      - conditions:
          condition: template
          value_template: "{{ (trigger.event.data.event | string)[:1] == \"2\" }}"
        sequence:
          service: light.turn_on
          data_template:
            entity_id: "{{ light_entity }}"
            brightness_step_pct: 20
      - conditions:
          condition: template
          value_template: "{{ (trigger.event.data.event | string)[:1] == \"3\" }}"
        sequence:
          service: light.turn_on
          data_template:
            entity_id: "{{ light_entity }}"
            brightness_step_pct: -20
      - conditions:
          condition: template
          value_template: "{{ (trigger.event.data.event | string)[:1] == \"4\" }}"
        sequence:
          service: light.turn_off
          data_template:
            entity_id: "{{ light_entity }}"
